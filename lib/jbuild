(rule
 (with-stdout-to
  "generated_ffi.ml"
  (run "../ffi/stubgen.exe" -ml)))

(rule
 (with-stdout-to
  "generated_ffi_stubs.c"
  (run "../ffi/stubgen.exe" -c)))


(library
 ((name wlroots)
  (public_name wlroots)
  (modules (wlroots generated_ffi))
  (c_names (generated_ffi_stubs))
  (c_flags ((:standard \ -Werror -pedantic -Wall -Wunused) -w
            (:include ../config/wlroots-ccopt.sexp)
            (:include ../config/wayland-server-ccopt.sexp)
            (:include ../config/pixman-1-ccopt.sexp)))
  (c_library_flags (:standard
                    (:include ../config/wlroots-cclib.sexp)
                    (:include ../config/wayland-server-cclib.sexp)
                    (:include ../config/pixman-1-cclib.sexp)
                    ))
  (flags ((:standard -safe-string) -w -9-27-32-34))
  (libraries (wlroots_types_f
              wlroots_ffi_f
              wlroots_common
              ctypes.stubs ctypes
              unix-time.unix mtime.clock.os))
  ))

(jbuild_version 1)
